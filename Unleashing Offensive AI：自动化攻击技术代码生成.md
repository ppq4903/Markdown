# Unleashing Offensive AI：自动化攻击技术代码生成的可行性验证

| 发表期刊     | Computers & Security 147 (2024) 104077                       |
| ------------ | ------------------------------------------------------------ |
| 作者         | Eider Iturbe 等（来自西班牙 TECNALIA 研究中心与巴斯克地区大学） |
| 核心研究方向 | 基于大型语言模型（LLM）的攻击性人工智能应用，实现自动化生成网络攻击技术代码，并验证其可行性与风险 |

## 一、研究背景

- AI 可自动化安全任务（如漏洞识别、威胁检测），整合到 NIST 网络安全框架的 **“识别、保护、检测、响应、恢复”** 五大功能中，提升安全专家决策效率。
- AI 技术（如 LLM、生成对抗网络 GAN）被黑客利用，形成 “攻击性 AI”，用于制造复杂攻击（如零日漏洞利用、供应链攻击、DDoS 攻击），且黑客商业模式向 “黑客即服务” 转变，攻击门槛降低。

勒索软件、恶意软件是顶级威胁，数字转型与新技术 adoption 导致攻击数量持续增加。

传统防御手段（如攻击溯源、基础设施摧毁）难以长期对抗高复杂度威胁，黑客可快速调整策略、重建基础设施。

需实证验证攻击性 AI 的实际风险，同时探索其在防御端的反向应用（如增强安全评估）。

## 二、核心概念

### 攻击性AI

“利用或滥用 AI 完成恶意任务”，可突破传统攻击技术限制，提升攻击效率与复杂度（如 GAN 生成虚假数据、LLM 生成攻击代码）。

### MITRE  ATT&CK 框架

全球公认的网络威胁知识库，基于真实攻击案例（尤其是高级持续性威胁 APT）定义攻击战术、技术与流程（TTPs），其中 “企业版矩阵” 覆盖 Windows、Linux、云等环境，是本研究的攻击技术参考标准。

## 三、研究方法&实验设计

### 研究假设

核心假设：AI 可提升网络攻击自动化能力，具体通过两个子假设验证：

- **H1**：攻击者无需大量努力即可生成有效攻击代码；
- **H2**：攻击者无需具备攻击技术编程的先验知识。

### 实验

#### AI 自动化生成攻击代码

- **工具与数据来源**：使用 OpenAI ChatGPT 3.5（通过 Python OpenAI 库调用），基于 MITRE ATT&CK 企业版（12.1 版本）的子技术（Sub-technique）生成代码（优先选择子技术而非通用技术，因前者更具体）。
- **平台覆盖**：聚焦工业界主流操作系统 ——Windows（桌面端主导）和 Linux（服务器端主导），共生成 565 个可执行代码片段（Windows 362 个，Linux 203 个）。
- **提示词（Prompt）设计**：无需 “越狱”（Jailbreak）技术，直接利用 **MITRE ATT&CK 的合法属性**（战术名称、子技术名称、描述、平台、CAPEC 攻击模式 ID）构建提示词，避免被 ChatGPT 判定为恶意请求。

#### 攻击代码执行与证据收集

- **沙箱环境**：搭建 8 台不同版本操作系统的机器（Windows 7/10/11/Server 2016/2019，Ubuntu 18.04/20.04/22.04），配置 LAN 网络与互联网访问（支持横向移动测试）。
- **执行条件**：假设目标机器已被初步入侵，且 Windows 机器允许 PowerShell 脚本执行（符合真实攻击场景中 “人为疏忽导致漏洞” 的现状）。
- **证据采集**：记录执行时间戳、返回码（0 表示成功）、标准输出 / 错误、异常信息、自动生成的二进制文件。

#### 结果评估&分类

成功；有效-需小幅度更新（Effective - Minor updates）；有效-需大幅度更新（Effective within limits - Major updates）；无效；错误代码

新的基于人工智能的网络安全评估自动化方法，增强了以动态方式生成攻击技术的能力，并向网络安全专家提供攻击技术代码片段的蓝图，以实现更快和改进的评估过程。

## 四、实验结果

### 整体效果

“成功”“有效 - 小幅更新”“有效 - 大幅更新” 三类，**正向结果占比 48.32%**；其中 “成功 + 有效 - 小幅更新” 占比 16%

“无效”（21.68%）与 “错误代码”（30%）；错误代码多因 ChatGPT 将 MITRE 框架关联为 “防御工具”，误生成防御逻辑

### 平台差异

Linux 代码效果优于 Windows

### 战术效果

对于正向结果：

1. 初始访问（TA0001）：攻击者突破目标边界的核心阶段，AI 生成代码可实现钓鱼链接 / 附件等攻击；
2. 防御规避（TA0005）：如清除命令历史（T1070.003）、禁用防火墙（T1562.004），代码成功率高；
3. 发现（TA0007）：Linux 平台表现突出，可*自动化探测目标系统信息*（如进程、文件）；
4. 持久化（TA0003）：Windows 平台优势战术，确保攻击后长期控制目标；
5. 权限提升（TA0004）：Windows 平台可生成提权脚本，需小幅配置即可生效。

## 五、应用价值

- 可整合到 “漏洞与攻击模拟（BAS）平台”（如 MITRE Caldera），动态生成攻击代码，帮助企业提前发现安全漏洞，提升系统抗攻击能力；
  - 增强 BAS 平台的动态攻击生成能力，补充现有攻击库（如 Caldera）
  - 预测黑客可能利用的 AI 攻击技术，提前制定防御策略
- 未来需开发 “专精于攻击模拟的 LLM”，结合长期记忆能力与更丰富的攻击数据，提升代码成功率。
- 扩展攻击平台覆盖（如 macOS、云环境），完善 MITRE ATT&CK 全技术验证。